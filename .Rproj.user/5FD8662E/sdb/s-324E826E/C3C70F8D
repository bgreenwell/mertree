{
    "contents" : "#' Extract Formula Components\n#'\n#' Extract various components from a \\code{mertree} model formula.\n#'\n#' @param formula A valid \\code{mertree} model formula. See \\code{\\link{lmer}}\n#'   for details.\n#' @rdname formula-components\n#' @export\nget_response_name <- function(formula) {\n  if(length(formula) < 3) {\n    stop(\"no response\")\n  }\n  resp <- formula[[2L]]\n  if(!is.name(resp)) {\n    stop(\"response is not a name\")\n  }\n  deparse(resp)\n}\n\n\n#' @rdname formula-components\n#' @importFrom lme4 nobars\n#' @export\nget_fixed_formula <- function(formula) {\n  deparse(nobars(formula)[[3L]])\n}\n\n\n#' @rdname formula-components\n#' @importFrom lme4 findbars\n#' @export\nget_random_formula <- function(formula) {\n  paste0(\"(\", findbars(formula), \")\", collapse = \" + \")\n}\n\n\n#' Make New Formula\n#'\n#' Build model formulas character vectors describing the response name, fixed\n#' effects structure, and (if required) random effects structure of the model.\n#'\n#' @rdname formula-build\n#'\n#' @param response Character string specifying the name of the response.\n#' @param fixed Character string specifying the fixed effects structure.\n#' @param random Character string specifying the random effects structure.\n#'\n#' @export\nmake_lmer_formula <- function(response, fixed, random) {\n  if (missing(random)) {\n    formula(paste(response, fixed, sep = \" ~ \"))\n  } else {\n    formula(paste(response, paste(fixed, random, sep = \" + \"), sep = \" ~ \"))\n  }\n}\n\n\n#' @rdname formula-build\n#' @export\nmake_tree_formula <- function(response, fixed) {\n  formula(paste(response, fixed, sep = \" ~ \"))\n}\n",
    "created" : 1450885551542.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3311356367",
    "id" : "C3C70F8D",
    "lastKnownWriteTime" : 1450913223,
    "path" : "~/Desktop/Dropbox/devel/mertree/R/formula.R",
    "project_path" : "R/formula.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}